local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer

local RobloxUI = {}

function RobloxUI:CreateWindow(titleText)
    titleText = titleText or "Roblox Library"

    local ScreenGui = Instance.new("ScreenGui", game:GetService("CoreGui"))  
    ScreenGui.Name = "RobloxUILibrary"  

    local MainFrame = Instance.new("Frame")  
    MainFrame.Size = UDim2.new(0, 500, 0, 300)  
    MainFrame.Position = UDim2.new(0.5, -250, 0.5, -150)  
    MainFrame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)  
    MainFrame.BorderSizePixel = 0  
    MainFrame.Parent = ScreenGui  
    MainFrame.Active = true  
    MainFrame.Draggable = true  

    local Title = Instance.new("TextLabel")  
    Title.Text = titleText .. "  "  
    Title.Size = UDim2.new(1, -60, 0, 30)  
    Title.BackgroundColor3 = Color3.fromRGB(245, 245, 245)  
    Title.TextColor3 = Color3.fromRGB(0, 0, 0)  
    Title.Font = Enum.Font.SourceSans  
    Title.TextSize = 16  
    Title.TextXAlignment = Enum.TextXAlignment.Left  
    Title.Parent = MainFrame  

    local MinimizeButton = Instance.new("TextButton")  
    MinimizeButton.Text = "—"  
    MinimizeButton.Size = UDim2.new(0, 30, 0, 30)  
    MinimizeButton.Position = UDim2.new(1, -60, 0, 0)  
    MinimizeButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)  
    MinimizeButton.TextColor3 = Color3.fromRGB(0, 0, 0)  
    MinimizeButton.Font = Enum.Font.SourceSans  
    MinimizeButton.TextSize = 18  
    MinimizeButton.Parent = MainFrame  

    local CloseButton = Instance.new("TextButton")  
    CloseButton.Text = "X"  
    CloseButton.Size = UDim2.new(0, 30, 0, 30)  
    CloseButton.Position = UDim2.new(1, -30, 0, 0)  
    CloseButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)  
    CloseButton.TextColor3 = Color3.fromRGB(0, 0, 0)  
    CloseButton.Font = Enum.Font.SourceSans  
    CloseButton.TextSize = 18  
    CloseButton.Parent = MainFrame  

    CloseButton.MouseButton1Click:Connect(function()  
        ScreenGui:Destroy()  
    end)  

    local Sidebar = Instance.new("Frame")  
    Sidebar.Size = UDim2.new(0, 140, 1, -30)  
    Sidebar.Position = UDim2.new(0, 0, 0, 30)  
    Sidebar.BackgroundColor3 = Color3.fromRGB(250, 250, 250)  
    Sidebar.BorderSizePixel = 0  
    Sidebar.Parent = MainFrame  

    local ContentArea = Instance.new("ScrollingFrame")  
    ContentArea.Size = UDim2.new(1, -140, 1, -30)  
    ContentArea.Position = UDim2.new(0, 140, 0, 30)  
    ContentArea.CanvasSize = UDim2.new(0, 0, 2, 0)  
    ContentArea.ScrollBarThickness = 6  
    ContentArea.ScrollBarImageColor3 = Color3.fromRGB(51, 95, 254)  
    ContentArea.BackgroundColor3 = Color3.fromRGB(255, 255, 255)  
    ContentArea.BorderSizePixel = 0  
    ContentArea.Parent = MainFrame  

    local UserFrame = Instance.new("Frame")  
    UserFrame.Size = UDim2.new(1, 0, 0, 50)  
    UserFrame.Position = UDim2.new(0, 0, 1, -50)  
    UserFrame.BackgroundColor3 = Color3.fromRGB(245, 245, 245)  
    UserFrame.BorderSizePixel = 0  
    UserFrame.Parent = Sidebar  

    local ProfilePic = Instance.new("ImageLabel")  
    ProfilePic.Size = UDim2.new(0, 30, 0, 30)  
    ProfilePic.Position = UDim2.new(0, 10, 0.5, -15)  
    ProfilePic.BackgroundTransparency = 1  
    ProfilePic.Image = Players:GetUserThumbnailAsync(LocalPlayer.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size100x100)  
    ProfilePic.Parent = UserFrame  

    local Username = Instance.new("TextLabel")  
    Username.Text = LocalPlayer.DisplayName  
    Username.Position = UDim2.new(0, 50, 0, 0)  
    Username.Size = UDim2.new(1, -60, 1, 0)  
    Username.BackgroundTransparency = 1  
    Username.TextColor3 = Color3.fromRGB(0, 0, 0)  
    Username.TextXAlignment = Enum.TextXAlignment.Left  
    Username.Font = Enum.Font.SourceSans  
    Username.TextSize = 14  
    Username.Parent = UserFrame  

    local TabList = {}  
    local isMinimized = false
    local originalSize = MainFrame.Size
    local originalPosition = MainFrame.Position

    MinimizeButton.MouseButton1Click:Connect(function()
        if not isMinimized then
            -- Minimizar: mostrar apenas a barra de título
            MainFrame.Size = UDim2.new(0, 500, 0, 30)
            isMinimized = true
        else
            -- Restaurar: mostrar a janela completa
            MainFrame.Size = originalSize
            MainFrame.Position = originalPosition
            isMinimized = false
        end
    end)

    function RobloxUI:CreateTab(name, icon)  
        local Tab = Instance.new("TextButton")  
        Tab.Size = UDim2.new(1, -20, 0, 40)  
        Tab.Position = UDim2.new(0, 10, 0, 10 + #TabList * 50)  
        Tab.Text = "  " .. name  
        Tab.BackgroundColor3 = Color3.fromRGB(240, 240, 240)  
        Tab.TextColor3 = Color3.fromRGB(0, 0, 0)  
        Tab.Font = Enum.Font.SourceSans  
        Tab.TextSize = 16  
        Tab.TextXAlignment = Enum.TextXAlignment.Left  
        Tab.BorderSizePixel = 0  
        Tab.AutoButtonColor = false  
        Tab.Parent = Sidebar  

        local Icon = Instance.new("ImageLabel")  
        Icon.Size = UDim2.new(0, 20, 0, 20)  
        Icon.Position = UDim2.new(0, 5, 0.5, -10)  
        Icon.BackgroundTransparency = 1  
        Icon.Image = icon or "rbxassetid://7733960981" -- Ícone Roblox fixo  
        Icon.Parent = Tab  

        local TabFrame = Instance.new("Frame")  
        TabFrame.Size = UDim2.new(1, 0, 0, 300)  
        TabFrame.BackgroundTransparency = 1  
        TabFrame.Visible = (#TabList == 0)  
        TabFrame.Parent = ContentArea  

        local Section = Instance.new("TextLabel")  
        Section.Text = "Section"  
        Section.Size = UDim2.new(1, -20, 0, 30)  
        Section.Position = UDim2.new(0, 10, 0, 10)  
        Section.BackgroundTransparency = 1  
        Section.TextColor3 = Color3.fromRGB(51, 95, 254)  
        Section.Font = Enum.Font.SourceSans  
        Section.TextSize = 16  
        Section.TextXAlignment = Enum.TextXAlignment.Left  
        Section.Parent = TabFrame  

        local yPos = 50  

        local tabData = {}  

        function tabData:AddButton(text, callback)  
            local Button = Instance.new("TextButton")  
            Button.Size = UDim2.new(1, -20, 0, 30)  
            Button.Position = UDim2.new(0, 10, 0, yPos)  
            Button.Text = text  
            Button.BackgroundColor3 = Color3.fromRGB(51, 95, 254)  
            Button.TextColor3 = Color3.fromRGB(255, 255, 255)  
            Button.Font = Enum.Font.SourceSans  
            Button.TextSize = 16  
            Button.BorderSizePixel = 0  
            Button.AutoButtonColor = true  
            Button.Parent = TabFrame  

            Button.MouseButton1Click:Connect(function()  
                if callback then callback() end  
            end)  

            yPos += 40  
        end  

        Tab.MouseButton1Click:Connect(function()  
            for _, obj in pairs(ContentArea:GetChildren()) do  
                if obj:IsA("Frame") then obj.Visible = false end  
            end  
            TabFrame.Visible = true  
        end)  

        table.insert(TabList, Tab)  
        return tabData  
    end  

    return RobloxUI
end

return RobloxUI
